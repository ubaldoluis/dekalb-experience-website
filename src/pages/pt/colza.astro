---
import PageLayout from "../../layouts/PageLayout.astro";
import ProductCard from "../../components/ProductCard.astro";
import BeneficiosCarousel from "../../components/BeneficiosCarousel.astro";
import ScrollReveal from "../../components/scroll-reveal/ScrollReveal.astro";
import { getColzaContent } from "../../utils/prismic";
import { renderRichText } from "../../utils/prismic-rich-text";
import * as prismic from "@prismicio/client";

const lang = "pt";
let colzaContent = null;

try {
  colzaContent = await getColzaContent(lang);
} catch (error) {
  console.error("Error fetching Colza content:", error);
}

// Fallback content si no hay datos de Prismic
const defaultContent = {
  hero: {
    titulo: "La genetica más avanzada",
    descripcion: "Supera todos los desafíos con las armas adecuadas para tu campo.",
    imagen_fondo: undefined,
    imagen_fondo_mobile: undefined,
  },
  introduccion: {
    titulo: "Soluciones diseñadas para actuar en diferentes condiciones, afrontando desafíos y asegurando tu rendimiento y rentabilidad.",
    texto: "En Bayer te recomendamos las soluciones precisas que necesitas en tu campo; por eso, ponemos a tu disposición un amplio rango de soluciones diseñadas para actuar en diferentes condiciones.",
  },
  beneficios: [],
  ciclo_crecimiento: {
    titulo: "Ciclo de Crecimiento",
    imagen: undefined,
    texto: [],
  },
  productos_fila_1: [],
  productos_fila_2: [],
  productos_fila_3: [],
  card_fieldview: {
    logo: undefined,
    imagen_movil: undefined,
    texto: "",
    link_fieldview: "/pt/fieldview",
  },
};

const content = colzaContent || defaultContent;
---

<PageLayout
  title="DEKALB Colza"
  description={content.hero.descripcion}
  lang={lang}
>
  <!-- Hero Section -->
  <section class="colza-hero">
    <div
      class="colza-hero-gradient"
      style={content.hero.imagen_fondo?.url
        ? `background-image: url("${content.hero.imagen_fondo.url}");`
        : ""}
    >
    </div>
    {
      content.hero.imagen_fondo_mobile?.url && (
        <div class="colza-hero-mobile-image">
          <img
            src={content.hero.imagen_fondo_mobile.url}
            alt={content.hero.imagen_fondo_mobile.alt || ""}
            loading="lazy"
          />
        </div>
      )
    }
    <div class="container">
      <ScrollReveal>
        <div class="colza-hero-content">
          <h1 class="colza-hero-title">{content.hero.titulo}</h1>
          <p class="colza-hero-description">{content.hero.descripcion}</p>
        </div>
      </ScrollReveal>
    </div>
  </section>

  <!-- Introducción Section -->
  <section class="colza-intro">
    <div class="container">
      <ScrollReveal>
        <div class="colza-intro-content">
          <h2 class="colza-intro-title">{content.introduccion.titulo}</h2>
          <p class="colza-intro-text">{content.introduccion.texto}</p>
        </div>
      </ScrollReveal>
    </div>
  </section>

  <!-- Beneficios Carousel -->
  {
    content.beneficios.length > 0 && (
      <section class="colza-beneficios">
        <div class="container">
          <ScrollReveal>
            <BeneficiosCarousel beneficios={content.beneficios} lang={lang} />
          </ScrollReveal>
        </div>
      </section>
    )
  }

  <!-- Ciclo de Crecimiento Section -->
  <section class="colza-ciclo">
    <div class="container">
      <ScrollReveal>
        <h2 class="colza-ciclo-title">{content.ciclo_crecimiento.titulo}</h2>
        <div class="colza-ciclo-wrapper">
          {content.ciclo_crecimiento.imagen?.url && (
            <div class="colza-ciclo-image">
              <img
                src={content.ciclo_crecimiento.imagen.url}
                alt={content.ciclo_crecimiento.imagen.alt || content.ciclo_crecimiento.titulo}
                loading="lazy"
              />
            </div>
          )}
          <div class="colza-ciclo-content">
            <div
              class="colza-ciclo-text"
              set:html={renderRichText(content.ciclo_crecimiento.texto)}
            />
          </div>
        </div>
      </ScrollReveal>
    </div>
  </section>

  <!-- Productos Fila 1 (2 cards grandes) -->
  {
    content.productos_fila_1.length > 0 && (
      <section class="colza-productos colza-productos-fila-1">
        <div class="container">
          <ScrollReveal>
            <div class="colza-productos-grid colza-productos-grid-2">
              {content.productos_fila_1.map((producto) => (
                <ProductCard
                  imagen={producto.imagen}
                  titulo={producto.titulo}
                  descripcion={producto.descripcion}
                />
              ))}
            </div>
          </ScrollReveal>
        </div>
      </section>
    )
  }

  <!-- Productos Fila 2 (3 cards medianas) -->
  {
    content.productos_fila_2.length > 0 && (
      <section class="colza-productos colza-productos-fila-2">
        <div class="container">
          <ScrollReveal>
            <div class="colza-productos-grid colza-productos-grid-3">
              {content.productos_fila_2.map((producto) => (
                <ProductCard
                  imagen={producto.imagen}
                  titulo={producto.titulo}
                  descripcion={producto.descripcion}
                />
              ))}
            </div>
          </ScrollReveal>
        </div>
      </section>
    )
  }

  <!-- Productos Fila 3 (3 cards medianas) -->
  {
    content.productos_fila_3.length > 0 && (
      <section class="colza-productos colza-productos-fila-3">
        <div class="container">
          <ScrollReveal>
            <div class="colza-productos-grid colza-productos-grid-3">
              {content.productos_fila_3.map((producto) => (
                <ProductCard
                  imagen={producto.imagen}
                  titulo={producto.titulo}
                  descripcion={producto.descripcion}
                />
              ))}
            </div>
          </ScrollReveal>
        </div>
      </section>
    )
  }

  <!-- Card FieldView -->
  {
    content.card_fieldview.texto && (
      <section class="colza-fieldview-section">
        <div class="container">
          <ScrollReveal>
            <a
              href={content.card_fieldview.link_fieldview}
              class="colza-fieldview-link"
            >
              <div class="content-right-card-wrapper">
                {content.card_fieldview.imagen_movil?.url && (
                  <div class="content-right-card-image">
                    <img
                      src={content.card_fieldview.imagen_movil.url}
                      alt={content.card_fieldview.imagen_movil.alt || "FieldView"}
                      loading="lazy"
                    />
                  </div>
                )}
                <div class="content-right-card-content">
                  {content.card_fieldview.logo?.url && (
                    <div class="colza-fieldview-logo">
                      <img
                        src={content.card_fieldview.logo.url}
                        alt={content.card_fieldview.logo.alt || "FieldView"}
                        loading="lazy"
                      />
                    </div>
                  )}
                  <p class="colza-fieldview-text">
                    {content.card_fieldview.texto}
                  </p>
                </div>
              </div>
            </a>
          </ScrollReveal>
        </div>
      </section>
    )
  }
</PageLayout>

<style>
  /* Hero Section */
  .colza-hero {
    position: relative;
    padding: 0 0 var(--spacing-16) 0;
    background: linear-gradient(135deg, #006892 0%, #009ddb 100%);
    border-radius: 0 0 60px 60px;
    overflow: hidden;
    min-width: auto;
    min-height: 628px;
  }

  .colza-hero-gradient {
    display: none;
  }

  .colza-hero-mobile-image {
    position: relative;
    z-index: 1;
    width: 100%;
    display: block;
  }

  .colza-hero-mobile-image img {
    width: 100%;
    height: auto;
    display: block;
  }

  @media (min-width: 1024px) {
    .colza-hero-gradient {
      display: block;
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 100%;
      background-repeat: no-repeat;
      background-position: right top;
      background-size: contain;
      z-index: 0;
    }
    .colza-hero {
      position: relative;
      padding: var(--spacing-16) 0;
      background: linear-gradient(
        135deg,
        #006892 0%,
        #009ddb 70%,
        #ffffff 100%
      );
      border-radius: 0;
      border-bottom-left-radius: 60px;
      min-width: 500px !important;
      min-height: 628px;
      display: flex;
      align-items: center;
    }
    .colza-hero .container {
      display: flex;
      align-items: center;
      height: 100%;
    }
    .colza-hero-mobile-image {
      display: none;
    }
    .colza-hero-content {
      padding-top: 0;
    }
  }

  .colza-hero-content {
    position: relative;
    z-index: 1;
    max-width: 462px;
    padding-top: var(--spacing-20);
  }

  .colza-hero-title {
    font-size: 2rem;
    font-weight: 700;
    font-family: var(--font-family-primary);
    color: #ffffff;
    margin: 0 0 var(--spacing-4) 0;
    line-height: 2.2rem;
    letter-spacing: 0.96px;
  }

  .colza-hero-description {
    font-size: 1.2rem;
    font-weight: 400;
    font-family: var(--font-family-primary);
    color: #ffffff;
    margin: 0;
    line-height: 1.625rem;
  }

  /* Introducción Section */
  .colza-intro {
    padding: var(--spacing-16) 0;
    background-color: #ffffff;
  }

  .colza-intro-content {
    max-width: 707px;
    margin: 0 auto;
    text-align: center;
  }

  .colza-intro-title {
    font-size: 34px;
    font-weight: 700;
    font-family: var(--font-family-primary);
    color: #009ddb;
    margin: 0 0 var(--spacing-6) 0;
    line-height: 40.8px;
  }

  .colza-intro-text {
    font-size: 20px;
    font-weight: 400;
    font-family: var(--font-family-primary);
    color: #313639;
    margin: 0;
    line-height: 28px;
  }

  /* Beneficios Carousel */
  .colza-beneficios {
    padding: var(--spacing-8) 0;
    background-color: #ffffff;
  }

  /* Ciclo de Crecimiento Section */
  .colza-ciclo {
    padding: var(--spacing-16) 0;
    background-color: #ffffff;
  }

  .colza-ciclo-title {
    font-size: 48px;
    font-weight: 700;
    font-family: var(--font-family-primary);
    color: #00527f;
    text-align: center;
    margin: 0 0 var(--spacing-12) 0;
    letter-spacing: 0.96px;
    line-height: 48px;
  }

  .colza-ciclo-wrapper {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-6);
  }

  .colza-ciclo-image {
    width: 100%;
    background-color: #f4f4f4;
    border-radius: 12px;
    overflow: hidden;
    min-height: 300px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .colza-ciclo-image img {
    width: 100%;
    height: auto;
    display: block;
  }

  .colza-ciclo-content {
    width: 100%;
  }

  .colza-ciclo-text {
    font-size: 20px;
    font-weight: 400;
    font-family: var(--font-family-primary);
    color: #000000;
    line-height: 28px;
  }

  .colza-ciclo-text :global(p) {
    margin-bottom: var(--spacing-4);
  }

  @media (min-width: 1024px) {
    .colza-ciclo-wrapper {
      flex-direction: row;
      align-items: stretch;
      gap: var(--spacing-8);
    }

    .colza-ciclo-image {
      width: 50%;
      min-height: 441px;
    }

    .colza-ciclo-content {
      width: 50%;
      display: flex;
      align-items: center;
    }
  }

  /* Productos Sections */
  .colza-productos {
    padding: var(--spacing-16) 0;
    background-color: #ffffff;
  }

  .colza-productos-grid {
    display: grid;
    gap: var(--spacing-6);
    max-width: 1440px;
    margin: 0 auto;
  }

  .colza-productos-grid-2 {
    grid-template-columns: repeat(2, 1fr);
  }

  .colza-productos-grid-3 {
    grid-template-columns: repeat(3, 1fr);
  }


  @media (max-width: 1023px) {
    .colza-productos-grid-2,
    .colza-productos-grid-3 {
      grid-template-columns: 1fr;
    }
  }

  /* FieldView Card - Misma estructura que bloque final de Acceleron */
  .colza-fieldview-section {
    padding: var(--spacing-16) 0;
    background-color: #ffffff;
  }

  .colza-fieldview-link {
    text-decoration: none;
    display: block;
    transition: all var(--transition-base);
  }

  .colza-fieldview-link:hover {
    transform: translateY(-4px);
  }

  .colza-fieldview-section .content-right-card-wrapper {
    display: flex;
    flex-direction: column;
    gap: 0;
    align-items: stretch;
    background: linear-gradient(to left, #f5a81c 0%, #ffcb05 100%);
    border-radius: 12px 12px 12px 12px;
    overflow: hidden;
    min-height: 400px;
    position: relative;
  }

  .colza-fieldview-section .content-right-card-content {
    text-align: left;
    padding: var(--spacing-12) var(--spacing-8);
    display: flex;
    flex-direction: column;
    justify-content: center;
    position: relative;
    z-index: 2;
    order: 2;
  }

  .colza-fieldview-section .content-right-card-image {
    display: block;
    position: relative;
    overflow: hidden;
    order: 1;
    border-radius: 12px 12px 0 0;
  }

  .colza-fieldview-section .content-right-card-image img,
  .colza-fieldview-section .content-right-card-image picture {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  .colza-fieldview-logo {
    margin-bottom: var(--spacing-4);
  }

  .colza-fieldview-logo img {
    height: 80px;
    width: auto;
  }

  .colza-fieldview-text {
    font-size: 20px;
    font-weight: 400;
    font-family: var(--font-family-primary);
    color: #ffffff;
    margin: 0;
    line-height: 26px;
  }

  /* Mobile: Content Right Card - Imagen primero, contenido después */
  @media (max-width: 767px) {
    .colza-fieldview-section .content-right-card-image {
      border-radius: 12px 12px 0 0;
      min-height: 200px;
      max-height: 300px;
    }

    .colza-fieldview-section .content-right-card-image img,
    .colza-fieldview-section .content-right-card-image picture {
      border-radius: 12px 12px 0 0;
    }

    .colza-fieldview-section .content-right-card-content {
      border-radius: 0 0 12px 12px;
    }
  }

  /* Desktop: Content Right Card - 60% imagen / 40% contenido */
  @media (min-width: 1024px) {
    .colza-fieldview-section .content-right-card-wrapper {
      display: grid;
      grid-template-columns: 60% 40%;
      gap: 0;
      min-height: 400px;
      border-radius: 60px 12px 60px 12px;
      background: linear-gradient(to left, #f5a81c 0%, #ffcb05 100%);
    }

    .colza-fieldview-section .content-right-card-content {
      padding: var(--spacing-12) var(--spacing-12);
      order: unset;
    }

    .colza-fieldview-section .content-right-card-image {
      display: block;
      order: unset;
    }

    .colza-fieldview-section .content-right-card-image img,
    .colza-fieldview-section .content-right-card-image picture {
      object-fit: fill;
    }
  }

  /* Estilos para texto blanco dentro del contenido */
  .colza-fieldview-section .content-right-card-content :global(p),
  .colza-fieldview-section .content-right-card-content :global(strong),
  .colza-fieldview-section .content-right-card-content :global(em),
  .colza-fieldview-section .content-right-card-content :global(span),
  .colza-fieldview-section .content-right-card-content :global(h3),
  .colza-fieldview-section .content-right-card-content :global(h4) {
    color: #ffffff;
  }

  .colza-fieldview-section .content-right-card-content :global(strong) {
    font-weight: 700;
  }

  /* Tablet */
  @media (min-width: 768px) and (max-width: 1023px) {
    .colza-hero-title {
      font-size: 36px;
      line-height: 44px;
    }

    .colza-intro-title {
      font-size: 28px;
      line-height: 34px;
    }

    .colza-ciclo-title {
      font-size: 36px;
      line-height: 44px;
    }
  }

  /* Mobile */
  @media (max-width: 767px) {
    .colza-hero-title {
      font-size: 32px;
      line-height: 40px;
      letter-spacing: 0.5px;
    }

    .colza-hero-description {
      font-size: 18px;
      line-height: 24px;
    }

    .colza-intro-title {
      font-size: 24px;
      line-height: 30px;
    }

    .colza-intro-text {
      font-size: 18px;
      line-height: 24px;
    }


    .colza-ciclo-title {
      font-size: 32px;
      line-height: 40px;
      letter-spacing: 0.5px;
    }

    .colza-ciclo-text {
      font-size: 18px;
      line-height: 24px;
    }
  }
</style>
