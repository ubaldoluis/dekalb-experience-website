---
import PageLayout from '../../../layouts/PageLayout.astro';
import { getAllCatalogs } from '../../../utils/prismic';

const lang = 'es';
let catalogs: any[] = [];

try {
  catalogs = await getAllCatalogs(lang);
} catch (error) {
  console.error('Error fetching catalogs:', error);
}

// Filter catalogs by type
const maizCatalogs = catalogs.filter((c) => c.tipo === 'maiz');
const colzaCatalogs = catalogs.filter((c) => c.tipo === 'colza');

// Group maiz catalogs by subcategory
const geneticaCatalogs = maizCatalogs.filter((c) => c.subcategoria === 'genetica-agronomia');
const proteccionCatalogs = maizCatalogs.filter((c) => c.subcategoria === 'proteccion-cultivo');
---

<PageLayout title="CatÃ¡logos" description="Descarga de catÃ¡logos DEKALB" lang={lang}>
  <section class="catalogs-page">
    <div class="container">
      <header class="catalogs-header">
        <h1>CatÃ¡logos DEKALB</h1>
        <p>Descarga los catÃ¡logos y guÃ­as tÃ©cnicas mÃ¡s recientes</p>
      </header>

      <!-- DEKALB MaÃ­z -->
      <section class="catalog-section">
        <h2 class="catalog-section-title">DEKALB MaÃ­z</h2>

        <!-- GenÃ©tica y AgronomÃ­a -->
        <div class="catalog-subsection">
          <h3>GenÃ©tica y AgronomÃ­a</h3>
          <div class="catalogs-grid">
            {geneticaCatalogs.map((catalog) => (
              <a 
                href={catalog.url_pdf} 
                target="_blank" 
                rel="noopener noreferrer"
                class="catalog-card"
                download
              >
                <div class="catalog-icon">
                  {catalog.pais === 'espana' ? 'ðŸ‡ªðŸ‡¸' : 'ðŸ‡µðŸ‡¹'}
                </div>
                <h4 class="catalog-name">{catalog.nombre}</h4>
                <span class="catalog-download">Descargar PDF</span>
              </a>
            ))}
          </div>
        </div>

        <!-- ProtecciÃ³n de Cultivo -->
        {proteccionCatalogs.length > 0 && (
          <div class="catalog-subsection">
            <h3>ProtecciÃ³n de Cultivo</h3>
            <div class="catalogs-grid">
              {proteccionCatalogs.map((catalog) => (
                <a 
                  href={catalog.url_pdf} 
                  target="_blank" 
                  rel="noopener noreferrer"
                  class="catalog-card"
                  download
                >
                  <div class="catalog-icon">
                    {catalog.pais === 'espana' ? 'ðŸ‡ªðŸ‡¸' : 'ðŸ‡µðŸ‡¹'}
                  </div>
                  <h4 class="catalog-name">{catalog.nombre}</h4>
                  <span class="catalog-download">Descargar PDF</span>
                </a>
              ))}
            </div>
          </div>
        )}
      </section>

      <!-- DEKALB Colza -->
      {colzaCatalogs.length > 0 && (
        <section class="catalog-section">
          <h2 class="catalog-section-title">DEKALB Colza</h2>
          <div class="catalogs-grid">
            {colzaCatalogs.map((catalog) => (
              <a 
                href={catalog.url_pdf} 
                target="_blank" 
                rel="noopener noreferrer"
                class="catalog-card"
                download
              >
                <div class="catalog-icon">
                  {catalog.pais === 'espana' ? 'ðŸ‡ªðŸ‡¸' : 'ðŸ‡µðŸ‡¹'}
                </div>
                <h4 class="catalog-name">{catalog.nombre}</h4>
                <span class="catalog-download">Descargar PDF</span>
              </a>
            ))}
          </div>
        </section>
      )}

      {catalogs.length === 0 && (
        <div class="catalogs-empty">
          <p>No hay catÃ¡logos disponibles en este momento.</p>
        </div>
      )}
    </div>
  </section>
</PageLayout>

<style>
  .catalogs-page {
    padding: var(--spacing-16) 0;
  }

  .catalogs-header {
    text-align: center;
    margin-bottom: var(--spacing-12);
  }

  .catalogs-header h1 {
    font-size: var(--font-size-4xl);
    margin-bottom: var(--spacing-4);
  }

  .catalogs-header p {
    font-size: var(--font-size-lg);
    color: var(--color-gray-600);
  }

  .catalog-section {
    margin-bottom: var(--spacing-12);
  }

  .catalog-section-title {
    font-size: var(--font-size-3xl);
    font-weight: var(--font-weight-bold);
    color: var(--color-dekalb-primary);
    margin-bottom: var(--spacing-6);
    padding-bottom: var(--spacing-4);
    border-bottom: 3px solid var(--color-dekalb-primary);
  }

  .catalog-subsection {
    margin-bottom: var(--spacing-8);
  }

  .catalog-subsection h3 {
    font-size: var(--font-size-xl);
    font-weight: var(--font-weight-semibold);
    margin-bottom: var(--spacing-4);
    color: var(--color-gray-800);
  }

  .catalogs-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: var(--spacing-4);
  }

  .catalog-card {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--spacing-3);
    padding: var(--spacing-6);
    background: var(--color-white);
    border: 2px solid var(--color-gray-300);
    border-radius: var(--radius-lg);
    text-decoration: none;
    transition: all var(--transition-base);
    text-align: center;
  }

  .catalog-card:hover {
    border-color: var(--color-dekalb-primary);
    box-shadow: var(--shadow-md);
    transform: translateY(-4px);
    background: var(--color-gray-50);
  }

  .catalog-icon {
    font-size: 3rem;
    line-height: 1;
  }

  .catalog-name {
    font-size: var(--font-size-base);
    font-weight: var(--font-weight-semibold);
    color: var(--color-gray-900);
    margin: 0;
  }

  .catalog-download {
    font-size: var(--font-size-sm);
    color: var(--color-dekalb-primary);
    font-weight: var(--font-weight-semibold);
  }

  .catalogs-empty {
    text-align: center;
    padding: var(--spacing-12);
    color: var(--color-gray-600);
  }

  @media (max-width: 767px) {
    .catalogs-grid {
      grid-template-columns: 1fr;
    }
  }
</style>

